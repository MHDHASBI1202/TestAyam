<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pesan ke Pemasok</title>
    <link rel="stylesheet" href="styles/main.css">
    <style>
        .supplier-card {
            border: 1px solid #ddd;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <img src="Gemini_Generated_Image_sxi7y0sxi7y0sxi7.png" alt="Logo Ayam Djuragan" class="logo-sidebar">
        <h2>Ayam Djuragan</h2>
        <nav>
            <a href="dashboard-manager.html">Dashboard</a>
            <a href="stok-list.html">Lihat Stok & Notifikasi</a>
            <a href="laporan-prediksi.html">Laporan Hasil Prediksi</a>
            <a href="daftar-belanja-pasar.html">Daftar Belanja Pasar</a>
            <a href="pilih-pemasok.html" class="active">Pesan ke Pemasok</a>
            <a href="input-barang-masuk.html">Input Barang Masuk</a>
            <a href="log-notifikasi.html">Log Notifikasi</a>
            <a href="laporan-audit.html">Laporan Audit</a>
            <a href="data-master.html">Data Master</a>
            <a href="index.html">Logout</a>
        </nav>
    </div>

    <div class="main-content">
        <div class="header-bar">
            <h1>Pilih Pemasok & Kirim Permintaan</h1>
        </div>

        <div class="card">
            <h2>Daftar Kebutuhan Pembelian (Otomatis)</h2>
            <p style="margin-bottom: 15px;">Daftar ini ditujukan untuk pembelian melalui Pemasok (bukan pasar).</p>
            <table>
                <thead>
                    <tr>
                        <th>Bahan Baku</th>
                        <th>Stok Saat Ini</th>
                        <th style= "max-width: 100px;">Status Ketersediaan (Batas Minimum)</th>
                        <th style= "max-width: 120px;">Jumlah Saran Beli (Untuk 7 Hari)</th>
                        <th>Satuan</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Ayam Potong (Beku)</td>
                        <td>5</td>
                        <td style="color: red; font-weight: bold;">Kurang (10)</td>
                        <td style="color: red; font-weight: bold;">65</td>
                        <td>Kg</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="card" style="margin-top: 30px;">
            <h2>Pilih Pemasok untuk Pengadaan Ayam </h2>
            
            <div class="supplier-card">
                <div style="flex: 1;">
                    <h3>Supplier Ayam Sempurna</h3>
                    <p>Kontak: 0812-xxxx-1234 (WA)</p>
                </div>

                <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 8px;">
                    
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <label style="font-size: 14px;">Jumlah:</label>
                        <select id="pilihOpsi1" onchange="cekOpsi('1')" style="padding: 8px; border-radius: 4px; border: 1px solid #ccc;">
                            <option value="saran">Sesuai Saran (65 Kg)</option>
                            <option value="manual">Input Manual...</option>
                        </select>
                    </div>

                    <input type="number" id="inputManual1" placeholder="Masukkan Jumlah (Kg)" 
                           style="display: none; width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">

                    <button class="btn btn-primary" style="width: 100%;" onclick="kirimPermintaan('Supplier Ayam Sempurna', '1')">Kirim Permintaan</button>
                </div>
            </div>

            <div class="supplier-card">
                <div style="flex: 1;">
                    <h3>UD Segar Abadi</h3>
                    <p>Kontak: 0857-xxxx-5678 (WA)</p>
                </div>

                <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 8px;">
                    
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <label style="font-size: 14px;">Jumlah:</label>
                        <select id="pilihOpsi2" onchange="cekOpsi('2')" style="padding: 8px; border-radius: 4px; border: 1px solid #ccc;">
                            <option value="saran">Sesuai Saran (65 Kg)</option>
                            <option value="manual">Input Manual...</option>
                        </select>
                    </div>

                    <input type="number" id="inputManual2" placeholder="Masukkan Jumlah (Kg)" 
                           style="display: none; width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">

                    <button class="btn btn-primary" style="width: 100%;" onclick="kirimPermintaan('UD Segar Abadi', '2')">Kirim Permintaan</button>
                </div>
            </div>

            <p style="margin-top: 20px;">*Permintaan akan dikirim otomatis ke nomor WhatsApp pemasok.</p>
        </div>
    </div>
    <div id="successModal" class="modal-overlay">
    <div class="modal-content" style="text-align: center;">
        <h2 style="color: var(--success-color); margin-bottom: 10px;">âœ” Berhasil!</h2>
        <p>Permintaan pembelian telah dialihkan ke WhatsApp Pemasok.</p>
        <br>
        <button class="btn btn-primary" onclick="tutupModal('successModal')">Tutup</button>
    </div>
    </div>

    <script>
        // Fungsi mengecek opsi yang dipilih
        function cekOpsi(idSupplier) {
            var dropdown = document.getElementById('pilihOpsi' + idSupplier);
            var inputBox = document.getElementById('inputManual' + idSupplier);
            
            // Jika pilih "manual", munculkan kotak input. Jika tidak, sembunyikan.
            if (dropdown.value === 'manual') {
                inputBox.style.display = 'block';
                inputBox.focus(); // Langsung arahkan kursor biar enak
            } else {
                inputBox.style.display = 'none';
                inputBox.value = ""; // Bersihkan nilai lama
            }
        }

        function kirimPermintaan(namaSupplier, idSupplier) {
            var jumlahAkhir = 0;
            var opsi = document.getElementById('pilihOpsi' + idSupplier).value;

            if (opsi === 'manual') {
                jumlahAkhir = document.getElementById('inputManual' + idSupplier).value;
                // Validasi agar tidak kosong
                if (!jumlahAkhir || jumlahAkhir <= 0) {
                    alert("Harap masukkan jumlah manual dengan benar!");
                    // Kembalikan fokus ke input biar user sadar
                    document.getElementById('inputManual' + idSupplier).focus();
                    return; 
                }
            } else {
                // Ambil nilai saran
                jumlahAkhir = 65; 
            }

            // Tampilkan Modal Sukses (atau alert simulasi WA)
            alert("Membuka WhatsApp ke " + namaSupplier + "...\nPesan: 'Halo, saya pesan " + jumlahAkhir + " Kg Ayam.'");
            
            // Panggil modal sukses dari kode sebelumnya
            if(document.getElementById('successModal')) {
                 document.getElementById('successModal').style.display = 'flex';
            }
        }

        function tutupModal(id) {
            document.getElementById(id).style.display = 'none';
        }
    </script>
</body>
</html>